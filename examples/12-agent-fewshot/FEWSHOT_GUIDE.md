# 🎯 Few-shot 最佳实践指南

## 📚 什么是Few-shot Learning

Few-shot Learning是一种通过提供少量示例来改善AI模型表现的技术。在Agent开发中，Few-shot通过在系统提示词中包含多个高质量的输入输出示例，帮助模型理解期望的行为模式。

---

## 🧩 Few-shot vs Zero-shot

| 对比维度 | Zero-shot | Few-shot |
|---------|-----------|----------|
| **示例数量** | 0个，纯指令描述 | 2-5个典型示例 |
| **表达覆盖** | 依赖模型理解能力 | 明确展示多种表达方式 |
| **输出一致性** | 可能存在变化 | 高度一致 |
| **开发成本** | 低 | 中等 |
| **效果稳定性** | 中等 | 高 |

---

## 🎯 Few-shot示例设计原则

### 1. 覆盖性原则
确保示例覆盖主要的输入变体：
- **直接表达**："添加任务：A、B、C"
- **委婉表达**："记一下：A、B、C" 
- **情境表达**："心情不好，帮我想几个事做"

### 2. 多样性原则
避免示例过于相似：
```python
❌ 错误示例（过于相似）
示例1："添加：写报告、开会、发邮件"
示例2："添加：买菜、做饭、洗衣"

✅ 正确示例（多样化）
示例1："今天要做：写报告、开会、发邮件"（直接列举）
示例2："记一下：买菜、做饭、洗衣"（提醒式）
示例3："心情不好，给我安排点事"（情绪驱动）
```

### 3. 完整性原则
每个示例都应该包含完整的输入→思考→执行→结果流程。

---

## 🛠️ 实现Few-shot的技术要点

### 1. systemPrompt结构设计

```typescript
const systemPrompt = `
基础指令说明...

## Few-shot 示例对话：

**【示例 1】**
用户："${输入变体1}"

助手回复：
🧠 **思考过程：**
${详细的思考分析过程}

📋 **执行计划：**
${具体的执行计划}

✅ **执行结果：**
${预期的执行结果}

---

**【示例 2】**
...

**【示例 3】**
...

⚠️ **格式要求：**
- 严格的输出格式控制
- 禁止的行为明确列出
`;
```

### 2. 示例质量控制

```typescript
// 示例质量检查清单
const qualityChecklist = {
  input: {
    diversity: true,    // 输入表达是否多样化
    coverage: true,     // 是否覆盖主要场景
    realistic: true     // 是否符合真实用户表达
  },
  output: {
    consistent: true,   // 输出格式是否一致
    complete: true,     // 三段式结构是否完整
    precise: true       // 思考过程是否准确
  }
};
```

---

## 📈 Few-shot效果评估

### 1. 一致性评估
```bash
# 测试用例
测试1："帮我记录：任务A、任务B"
测试2："需要做的：任务A、任务B"  
测试3："添加待办：任务A、任务B"

# 评估指标
- 输出格式一致性：100%
- 功能调用正确性：100%
- 思考过程合理性：评分1-5分
```

### 2. 鲁棒性评估
```bash
# 边界用例测试
边界1："也许可以帮我想想任务"
边界2："你觉得我该做什么"
边界3："可能需要一些建议"

# 期望结果
- 避免模糊语气输出
- 保持三段式结构
- 拒绝无关闲聊
```

---

## 🎓 常见问题与解决方案

### Q1: 示例过多导致Token消耗大？
**A:** 控制示例数量在2-3个，优先质量而非数量。

### Q2: 用户输入超出示例覆盖范围？
**A:** 在格式要求中加入"遇到不确定情况时的处理方式"。

### Q3: 不同示例之间输出风格不统一？
**A:** 统一检查所有示例的输出格式，确保严格遵守模板。

---

## 🔗 进阶优化建议

### 1. 动态Few-shot
根据用户历史交互，动态选择最相关的示例。

### 2. 分层Few-shot  
针对不同意图类型，设计专门的示例集合。

### 3. 反馈驱动优化
收集用户反馈，持续优化示例质量。

---

## 📚 参考资料

- [Few-shot Learning论文](https://arxiv.org/abs/2005.14165)
- [GPT-3 Few-shot实践](https://arxiv.org/abs/2005.14165) 
- [Prompt Engineering指南](https://www.promptingguide.ai/) 
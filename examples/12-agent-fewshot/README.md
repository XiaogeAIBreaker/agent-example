# 🧠 Agent Few-shot - 多样化示例学习

## 📚 教学案例12 | 基于Agent CoT引入Few-shot学习

> 基于11-agent-cot进行迭代升级，从**Zero-shot单示例**升级为**Few-shot多示例**，引入多样化表达变体和输出一致性控制。

---

## 🎯 教学目标

在保留 Chain of Thought (CoT) 思考过程的基础上，升级系统提示词(systemPrompt)，从单一示例升级为多样化示例集，提升Agent对不同表达方式的理解和响应一致性。

## 🧠 核心理念

**Few-shot Learning** = 多样化示例 + 一致性输出：

1. **多样表达覆盖**：涵盖不同用户表达习惯的示例
2. **标准化输出**：无论输入如何变化，输出格式保持一致
3. **边界强化**：明确输出要求和禁止行为
4. **模板引导**：通过示例引导正确的思考模式

---

## 🧩 Few-shot 升级要点

### 📌 从Zero-shot到Few-shot的升级

**🔵 原有Zero-shot设计（案例11）：**
- 单一示例："今天心情不好，帮我想三个要做的事"
- 基础CoT格式说明
- 简单的工具说明

**🔴 升级Few-shot设计（案例12）：**
- 多样化示例：涵盖直接表达、提醒表达、情绪表达等变体
- 强化格式要求：严格的三段式结构控制
- 输出边界定义：禁止模糊语气和闲聊内容

### 📌 Few-shot示例设计策略

**【示例1 - 直接表达】**
```
用户："今天要做：写日报、整理桌面、联系客户"
→ 覆盖：任务列表式表达、直接明确的需求
```

**【示例2 - 提醒表达】**  
```
用户："记一下：洗衣服、去超市、打电话给老妈"
→ 覆盖：口语化表达、"记录"类意图识别
```

**【示例3 - 情绪表达】**
```
用户："今天心情不好，帮我想三个要做的事"  
→ 覆盖：情绪驱动需求、推荐类任务生成
```

---

## 🛠️ 技术实现要点

### 1. 升级的 systemPrompt 结构

```typescript
const systemPrompt = `
CoT基础格式定义...

## Few-shot 示例对话：

**【示例 1】**
用户："今天要做：写日报、整理桌面、联系客户"

助手回复：
🧠 **思考过程：**
用户列出了三个明确的任务，表达简洁直接...

📋 **执行计划：**
基于上述分析，我将调用三次addTodo功能...

✅ **执行结果：**
已成功添加三个任务到你的待办清单中。

---

**【示例 2】**
用户："记一下：洗衣服、去超市、打电话给老妈"
...

⚠️ **格式要求：**
- 每次回复必须完整包含 🧠 思考过程 / 📋 执行计划 / ✅ 执行结果 三段结构
- 严禁输出闲聊、重复内容、模糊语气（如"也许""可能"）
- 必须保持结构化、明确、严谨
`;
```

### 2. 一致性控制机制

```typescript
// 输出结构验证
const validateCoTResponse = (response: string) => {
  const hasThinking = response.includes('🧠 **思考过程：**');
  const hasPlan = response.includes('📋 **执行计划：**');
  const hasResult = response.includes('✅ **执行结果：**');
  
  return hasThinking && hasPlan && hasResult;
};
```

---

## 🎯 与Agent CoT的关键差异

| 特性 | 11-agent-cot | 12-agent-fewshot |
|-----|---------------|-------------------|
| **示例数量** | 1个基础示例 | 3个多变示例 |
| **表达覆盖** | 单一场景 | 多样化场景 |
| **输出控制** | 基础格式 | 严格边界要求 |
| **一致性** | 中等 | 高 |
| **鲁棒性** | 中等 | 高 |

---

## 🚀 快速开始

### 1. 环境配置
```bash
cd examples/12-agent-fewshot
npm install
```

### 2. 配置API密钥
```bash
cp env.example .env.local
# 编辑 .env.local 添加你的 DEEPSEEK_API_KEY
```

### 3. 启动应用
```bash
npm run dev
```

---

## 💡 推荐测试用例

### 测试表达变体识别
```
"帮我记录几个事情：买菜、洗车、约医生"
"需要做的：开会、写报告、发邮件" 
"添加任务：健身、阅读、整理房间"
```

### 测试输出一致性
```
"随便帮我想几个任务"
"今天很忙，不知道该做什么"
"心情烦躁，给我安排点事做"
```

### 测试边界控制
```
"你觉得我应该做什么呢？"
"可能需要做一些任务吧"
"也许你能帮我想想"
```

---

## 🎓 学习收获

通过本案例，你将掌握：

1. **Few-shot设计**: 如何构建有效的多示例学习模板
2. **表达变体覆盖**: 识别和处理不同用户表达习惯
3. **输出一致性控制**: 确保不同输入下的统一输出格式
4. **边界强化**: 定义明确的输出要求和禁止行为
5. **鲁棒性提升**: 提高Agent对各种输入的适应能力

---

## 🔗 相关资源

- [11-agent-cot](../11-agent-cot/README.md) - 前置教学案例
- [Few-shot Learning论文](https://arxiv.org/abs/2005.14165) - 理论基础
- [Few-shot最佳实践](./FEWSHOT_GUIDE.md) - 技术指南

---

**🎯 教学重点**: 从黑盒执行到透明决策，体验AI思维过程的可视化！

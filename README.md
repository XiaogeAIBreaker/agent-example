# 具有结构化AI操作的智能待办事项应用

这是一个具有**结构化AI操作**功能的待办事项应用。AI助手不仅能对话，还能通过输出结构化JSON直接操作待办事项，实现真正的智能交互。

## 🚀 核心特性

### 结构化AI操作
- **JSON指令输出**: AI助手输出标准JSON格式的操作指令
- **安全解析**: 使用安全的JSON解析工具处理AI输出
- **实时执行**: AI指令自动解析并执行相应操作
- **操作反馈**: 执行结果即时反馈给用户

### 支持的AI操作
- 🆕 **添加任务**: `{"action": "add", "task": "买牛奶"}`
- ✅ **标记完成**: `{"action": "complete", "task": "买牛奶"}`
- 🗑️ **删除任务**: `{"action": "delete", "task": "买牛奶"}`
- 📋 **查看列表**: `{"action": "list"}`

### 智能交互示例
```
用户: "帮我添加任务：学习编程"
AI: 好的，我来帮你添加这个任务。{"action": "add", "task": "学习编程"}
系统: ✅ 已添加任务："学习编程"

用户: "完成买牛奶的任务"
AI: 我来帮你标记完成。{"action": "complete", "task": "买牛奶"}
系统: ✅ 已标记完成："买牛奶"

用户: "删除过期的任务"
AI: 好的，我来删除这个任务。{"action": "delete", "task": "过期任务"}
系统: ✅ 已删除任务："过期任务"
```

## 🛠️ 技术实现

### AI Prompt Engineering
- **结构化指令**: 详细的system prompt指导AI输出标准JSON
- **操作规范**: 明确定义支持的操作类型和参数格式
- **上下文感知**: AI助手了解当前任务状态

### JSON解析与安全
- **正则提取**: 从AI回复中安全提取JSON部分
- **格式验证**: 验证JSON结构和字段类型
- **错误处理**: 优雅处理解析失败的情况

### 前端集成
- **实时监听**: 监听AI消息中的操作指令
- **自动执行**: 解析到有效操作后自动执行
- **状态同步**: 操作结果实时更新到界面

## 🎯 技术栈

- **前端框架**: Next.js 15.3.2 with React 19
- **AI集成**: Vercel AI SDK with DeepSeek
- **类型安全**: TypeScript + 严格类型检查
- **样式系统**: Tailwind CSS
- **状态管理**: React Hooks

## 📁 项目结构

```
app/
├── api/chat/route.ts          # 结构化AI API路由
├── components/
│   └── ChatSidebar.tsx        # 智能聊天侧边栏
├── utils/
│   └── jsonParser.ts          # JSON安全解析工具
├── page.tsx                   # 主页面（集成AI操作）
└── globals.css               # 全局样式
```

## 🚀 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 配置环境变量
创建 `.env.local` 文件：
```bash
# 复制示例文件
cp .env.local.example .env.local
```

编辑文件，添加DeepSeek API密钥：
```bash
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 3. 启动开发服务器
```bash
npm run dev
```

访问 [http://localhost:3000](http://localhost:3000) 体验应用。

## 🎮 使用指南

### 基本操作
1. 在左侧输入框手动添加任务
2. 点击复选框标记完成
3. 点击垃圾桶图标删除任务

### AI智能操作
在右侧AI助手中尝试以下指令：

#### 添加任务
- "帮我添加任务：买牛奶"
- "新建一个任务：学习编程"
- "添加：完成项目报告"

#### 标记完成
- "完成买牛奶这个任务"
- "标记学习编程为已完成"
- "把报告写完了"

#### 删除任务
- "删除买牛奶任务"
- "移除过期的任务"
- "删掉不需要的任务"

#### 查看列表
- "显示我的任务列表"
- "看看我有什么任务"
- "列出所有任务"

## 🔧 核心算法

### JSON解析流程
```typescript
1. 正则匹配提取JSON片段
2. JSON.parse()安全解析
3. 结构验证（action类型、必需字段）
4. 模糊匹配任务名称
5. 执行操作并返回结果
```

### 任务匹配算法
```typescript
// 支持模糊匹配，提高用户体验
const todoToComplete = todos.find(todo => 
  todo.text.toLowerCase().includes(taskText.toLowerCase()) ||
  taskText.toLowerCase().includes(todo.text.toLowerCase())
);
```

## 🛡️ 安全特性

- **输入验证**: 严格验证JSON结构和字段类型
- **错误处理**: 优雅处理所有可能的解析错误
- **操作限制**: 仅支持预定义的安全操作
- **状态隔离**: 操作仅影响当前用户的任务

## 🎓 教学价值

这个项目展示了：
1. **Prompt Engineering**: 如何设计有效的AI提示词
2. **结构化输出**: 让AI输出可执行的结构化数据
3. **安全解析**: 如何安全处理AI生成的代码/数据
4. **前端集成**: 将AI能力无缝集成到用户界面
5. **错误处理**: 构建健壮的AI应用的最佳实践

## 🔄 相比上一版本的改进

| 功能 | 03版本 | 04版本 |
|------|--------|--------|
| AI交互 | 纯对话 | 结构化操作 |
| 操作方式 | 手动点击 | AI直接执行 |
| 用户体验 | 传统交互 | 智能自动化 |
| 技术复杂度 | 简单集成 | 高级AI应用 |

## 📝 许可证

MIT License